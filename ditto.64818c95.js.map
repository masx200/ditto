{"version":3,"sources":["ditto.js"],"names":["$","ditto","content_id","sidebar_id","edit_id","back_to_top_id","loading_id","error_id","search_name","search_results_class","fragments_class","fragment_class","highlight_code","sidebar","edit_button","back_to_top_button","searchbar","github_username","github_repo","run","initialize","get","sidebar_file","data","init_searchbar","search","html","marked","selector","replace","keydown","searchbar_listener","addClass","css","height","fail","alert","show","on","animate","scrollTop","base_url","hash","location","index","window","open","hljs","initHighlightingOnLoad","router","build_text_matches_html","fragments","i","length","fragment","text","display_search_results","results_html","items","hide_errors","build_result_matches_html","matches","url","path","origin","text_matches","show_error","click","destination","event","which","q","val","replace_symbols","li_create_linkage","li_tag","header_level","html_safe_tag","attr","header","offset","top","original_color","color","create_youtube_embeds","token_regex","yt_embed_url","youtube_url_to_embed","youtube_url_extract","yt_regex","yt_url","String","match","embed_html","normalize_paths","find","map","src","slice","base_dir","split","join","err_msg","hide","stop_loading","clearInterval","loading_interval","page_getter","scrollTo","pathname","pop","setInterval","fadeIn","fadeOut","removeClass","compile_into_dom","cb","unescape_html","string","ignore_list","host","inArray","create_page_anchors","headers","push","j","each","block","highlightBlock","escape_html","MathJax","Extension","startNumber","labels","content","document","getElementById","Hub","Queue","console","error","setTimeout","github_search","query","github_api","ajax","Accept","done"],"mappings":"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","file":"ditto.64818c95.js","sourceRoot":"..","sourcesContent":["$(function($) {\n\n    var ditto = {\n        content_id: $(\"#content\"),\n        sidebar_id: $(\"#sidebar\"),\n\n        edit_id: $(\"#edit\"),\n        back_to_top_id: $(\"#back_to_top\"),\n\n        loading_id: $(\"#loading\"),\n        error_id: $(\"#error\"),\n\n        search_name: $(\"#search\"),\n        search_results_class: \".search_results\",\n        fragments_class: \".fragments\",\n        fragment_class: \".fragment\",\n\n        highlight_code: true,\n\n        // display elements\n        sidebar: true,\n        edit_button: true,\n        back_to_top_button: true,\n        searchbar: true,\n\n        // github specifics\n        github_username: null,\n        github_repo: null,\n\n        // initialize function\n        run: initialize\n    };\n\n    function initialize() {\n        // initialize sidebar and buttons\n        if (ditto.sidebar) {\n            init_sidebar_section();\n        }\n\n        if (ditto.back_to_top_button) {\n            init_back_to_top_button();\n        }\n\n        if (ditto.edit_button) {\n            init_edit_button();\n        }\n\n        // intialize highligh.js\n        if (ditto.highlight_code) {\n            hljs.initHighlightingOnLoad();\n        }\n\n        // page router\n        router();\n        $(window).on('hashchange', router);\n    }\n\n    function init_sidebar_section() {\n        $.get(ditto.sidebar_file, function(data) {\n\n            //加载完目录部分的markdown的回调函数\n            \n            ditto.sidebar_id.html(marked(data));\n\n            if (ditto.searchbar) {\n                init_searchbar();\n            }\n\n            //由于当作bootstrap导航栏,所以给sidebar中的ul增加class为\"navbar-nav\"\n            $(\"#sidebar  ul\").addClass(\"navbar-nav\")\n            $(\"#sidebar  h1\").addClass(\"nav-item\")\n            $(\"#sidebar  p\").addClass(\"nav-item\")\n            $(\"#sidebar a\").addClass(\"nav-link\")\n            $(\"#sidebar  h2\").addClass(\"nav-item\")\n            $(\"#sidebar  li\").addClass(\"nav-item\")\n            // $(\"#sidebar > a\").addClass(\"nav-link\")\n            // $(\"#sidebar >ul> li\").addClass(\"nav-item\")\n            // nav-item navbar-nav nav-link\n            $(\"#sidebar  ol\").addClass(\"navbar-nav\")\n            $(\"#sidebar  li\").addClass(\"nav-item\")\n            // $(\"#sidebar >ol>li> a\").addClass(\"nav-link\")\n            // $(\"#sidebar >ul>li> a\").addClass(\"nav-link\")\n            // $(\"#sidebar >h1> a\").addClass(\"nav-link\")\n            $(\"#sidebar  input\").addClass(\"nav-link\")\n\n            $(\"#my主体\").css(\"padding-top\", $(\"#my导航栏\").height());\n\n        }, \"text\").fail(function() {\n            alert(\"Opps! can't find the sidebar file to display!\");\n        });\n\n    }\n\n    function init_back_to_top_button() {\n        ditto.back_to_top_id.show();\n        ditto.back_to_top_id.on(\"click\", function() {\n            $(\"body, html\").animate({\n                scrollTop: 0\n            }, 200);\n        });\n    }\n\n    function init_edit_button() {\n        if (ditto.base_url === null) {\n            alert(\"Error! You didn't set 'base_url' when calling ditto.run()!\");\n\n        } else {\n            ditto.edit_id.show();\n            ditto.edit_id.on(\"click\", function() {\n                var hash = location.hash.replace(\"#\", \"/\");\n\n                if (hash === \"\") {\n                    hash = \"/\" + ditto.index.replace(\".md\", \"\");\n                }\n\n                window.open(ditto.base_url + hash + \".md\");\n                // open is better than redirecting, as the previous page history\n                // with redirect is a bit messed up\n            });\n        }\n    }\n\n    function init_searchbar() {\n        var sidebar = ditto.sidebar_id.html();\n        var match = \"[ditto:searchbar]\";\n\n        // html input searchbar\n        var search = \"<input name='\" + ditto.search_name.selector + \"'\";\n        search = search + \" type='search'\";\n        search = search + \" results='10'>\";\n\n        // replace match code with a real html input search bar\n        sidebar = sidebar.replace(match, search);\n        ditto.sidebar_id.html(sidebar);\n\n        // add search listener\n        $(\"input[name=\" + ditto.search_name.selector + \"]\").keydown(searchbar_listener);\n    }\n\n    function build_text_matches_html(fragments) {\n        var html = \"\";\n        var class_name = ditto.fragments_class.replace(\".\", \"\");\n\n        html += \"<ul class='\" + class_name + \"'>\";\n        for (var i = 0; i < fragments.length; i++) {\n            var fragment = fragments[i].fragment.replace(\"/[\\uE000-\\uF8FF]/g\", \"\");\n            html += \"<li class='\" + ditto.fragment_class.replace(\".\", \"\") + \"'>\";\n            html += \"<pre><code> \";\n            fragment = $(\"#hide\").text(fragment).html();\n            html += fragment;\n            html += \" </code></pre></li>\";\n        }\n        html += \"</ul>\";\n\n        return html;\n    }\n\n    function build_result_matches_html(matches) {\n        var html = \"\";\n        var class_name = ditto.search_results_class.replace(\".\", \"\");\n\n        html += \"<ul class='\" + class_name + \"'>\";\n        for (var i = 0; i < matches.length; i++) {\n            var url = matches[i].path;\n\n            if (url !== ditto.sidebar_file) {\n                var hash = \"#\" + url.replace(\".md\", \"\");\n                var path = window.location.origin + \"/\" + hash;\n\n                // html += \"<li>\";\n                html += \"<li class='link'>\";\n                html += url;\n                // html += \"<a href='\" + path +\"'>\" + url + \"</a>\";\n                html += \"</li>\";\n\n                var match = build_text_matches_html(matches[i].text_matches);\n                html += match;\n            }\n\n        }\n        html += \"</ul>\";\n\n        return html;\n    }\n\n    function display_search_results(data) {\n        var results_html = \"<h1>Search Results</h1>\";\n\n        if (data.items.length) {\n            hide_errors();\n            results_html += build_result_matches_html(data.items);\n        } else {\n            show_error(\"Opps.. Found no matches!\");\n        }\n\n        ditto.content_id.html(results_html);\n        $(ditto.search_results_class + \" .link\").click(function() {\n            var destination = \"#\" + $(this).html().replace(\".md\", \"\");\n            location.hash = destination;\n        });\n    }\n\n    function github_search(query) {\n        if (ditto.github_username && ditto.github_repo) {\n            // build github search api url string\n            var github_api = \"https://api.github.com/\";\n            var search = \"search/code?q=\";\n            var github_repo = ditto.github_username + \"/\" + ditto.github_repo;\n            var search_details = \"+in:file+language:markdown+repo:\";\n\n            var url = github_api + search + query + search_details + github_repo;\n            var accept_header = \"application/vnd.github.v3.text-match+json\";\n\n            $.ajax(url, {\n                headers: {\n                    Accept: accept_header\n                }\n            }).done(function(data) {\n                display_search_results(data);\n            });\n        }\n\n        if (ditto.github_username == null && ditto.github_repo == null) {\n            alert(\"You have not set ditto.github_username and ditto.github_repo!\");\n        } else if (ditto.github_username == null) {\n            alert(\"You have not set ditto.github_username!\");\n        } else if (ditto.github_repo == null) {\n            alert(\"You have not set ditto.github_repo!\");\n        }\n    }\n\n    function searchbar_listener(event) {\n        if (event.which === 13) {\n            // when user presses ENTER in search bar\n            var q = $(\"input[name=\" + ditto.search_name.selector + \"]\").val();\n            if (q !== \"\") {\n                location.hash = \"#search=\" + q;\n            } else {\n                alert(\"Error! Empty search query!\");\n            }\n        }\n    }\n\n    function replace_symbols(text) {\n        // replace symbols with underscore\n        return text.replace(/[&\\/\\\\#,+=()$~%.'\":*?<>{}\\ \\]\\[]/g, \"_\");\n    }\n\n    function li_create_linkage(li_tag, header_level) {\n        // add custom id and class attributes\n        html_safe_tag = replace_symbols(li_tag.text());\n        li_tag.attr(\"id\", html_safe_tag);\n        li_tag.attr(\"class\", \"link\");\n\n        // add click listener - on click scroll to relevant header section\n        $(ditto.content_id.selector + \" li#\" + li_tag.attr(\"id\")).click(function() {\n            // scroll to relevant section\n            var header = $(\"h\" + header_level + \".\" + li_tag.attr(\"id\"));\n            $('html, body').animate({\n                scrollTop: header.offset().top\n            }, 200);\n\n            // highlight the relevant section\n            original_color = header.css(\"color\");\n            header.animate({\n                color: \"#ED1C24\",\n            }, 500, function() {\n                // revert back to orig color\n                $(this).animate({\n                    color: original_color\n                }, 2500);\n            });\n        });\n    }\n\n    function create_page_anchors() {\n        // create page anchors by matching li's to headers\n        // if there is a match, create click listeners\n        // and scroll to relevant sections\n\n        // go through header level 2 and 3\n        for (var i = 2; i <= 4; i++) {\n            // parse all headers\n            var headers = [];\n            $(ditto.content_id.selector + ' h' + i).map(function() {\n                headers.push($(this).text());\n                $(this).addClass(replace_symbols($(this).text()));\n            });\n\n            // parse and set links between li and h2\n            $(ditto.content_id.selector + ' ul li').map(function() {\n                for (var j = 0; j < headers.length; j++) {\n                    if (headers[j] === $(this).text()) {\n                        li_create_linkage($(this), i);\n                    }\n                }\n            });\n        }\n    }\n\n    function youtube_url_extract(data) {\n        var yt_regex = /(https?\\:\\/\\/)?(www\\.youtube\\.com|youtu\\.?be)\\/.+/g;\n        var yt_url = String(data.match(yt_regex));\n        yt_url = yt_url.replace(/]/g, \"\");\n        return yt_url;\n    }\n\n    function youtube_url_to_embed(data) {\n        return data = data.replace(/watch\\?v\\=/g, \"embed/\");\n    }\n\n    function create_youtube_embeds(data) {\n        // replaces [ditto:youtube:<some youtube link>]\n        // with a proper youtube embed iframe\n        var token_regex = /\\[ditto\\:youtube:(https?\\:\\/\\/)?(www\\.youtube\\.com|youtu\\.?be)\\/.+\\]/g;\n        var yt_url = youtube_url_extract(data);\n        var yt_embed_url = youtube_url_to_embed(yt_url);\n\n        // youtube embed html\n        var embed_html = `<div class=\"youtube_video\">\n      <div style=\"position:relative;height:0;padding-bottom:56.25%\">\n        <iframe src=\"<link>?ecver=2\"\n          width=\"640\"\n          height=\"360\"\n          frameborder=\"0\"\n          style=\"position:absolute;width:100%;height:100%;left:0\"\n          allowfullscreen>\n        </iframe>\n      </div>\n    </div>`;\n        embed_html = embed_html.replace(\"<link>\", yt_embed_url);\n\n        // replace match code with youtube video\n        data = data.replace(token_regex, embed_html);\n        return data;\n    }\n\n    function normalize_paths() {\n        // images\n        ditto.content_id.find(\"img\").map(function() {\n            var src = $(this).attr(\"src\").replace(/^\\.\\//, \"\");\n            if ($(this).attr(\"src\").slice(0, 5) !== \"http\") {\n                var url = location.hash.replace(\"#\", \"\");\n\n                // split and extract base dir\n                url = url.split(\"/\");\n                var base_dir = url.slice(0, url.length - 1).join(\"/\");\n\n                // normalize the path (i.e. make it absolute)\n                if (base_dir) {\n                    $(this).attr(\"src\", base_dir + \"/\" + src);\n                } else {\n                    $(this).attr(\"src\", src);\n                }\n            }\n        });\n\n    }\n\n    function show_error(err_msg) {\n        ditto.error_id.html(err_msg);\n        ditto.error_id.show();\n    }\n\n    function hide_errors() {\n        ditto.error_id.hide();\n    }\n\n    function show_loading() {\n        ditto.loading_id.show();\n        ditto.content_id.html(\"\");\n        // clear content\n\n        // infinite loop until clearInterval() is called on loading\n        ditto.loading_interval = setInterval(function() {\n            ditto.loading_id.fadeIn(1000).fadeOut(1000);\n        }, 2000);\n\n    }\n\n    function stop_loading() {\n        clearInterval(ditto.loading_interval);\n        ditto.loading_id.hide();\n    }\n\n    function escape_github_badges(data) {\n        $(\"img\").map(function() {\n            var ignore_list = [\"travis-ci.com\", \"travis-ci.org\", \"coveralls.io\"];\n            var src = $(this).attr(\"src\");\n\n            var base_url = src.split(\"/\");\n            var protocol = base_url[0];\n            var host = base_url[2];\n\n            if ($.inArray(host, ignore_list) >= 0) {\n                $(this).attr(\"class\", \"github_badges\");\n            }\n        });\n        return data;\n    }\n\n    function page_getter() {\n        window.scrollTo(0, 0);\n        var path = location.hash.replace(\"#\", \"./\");\n\n        // default page if hash is empty\n        var current_page = location.pathname.split(\"/\").pop();\n        if (current_page === \"index.html\") {\n            path = location.pathname.replace(\"index.html\", ditto.index);\n            normalize_paths();\n\n        } else if (path === \"\") {\n            path = window.location + ditto.index;\n            normalize_paths();\n\n        } else {\n            path = path + \".md\";\n\n        }\n\n        // otherwise get the markdown and render it\n        show_loading();\n        $.get(path, function(data) {\n            //加载完主体部分的markdown的回调函数\n            $(\"#collapsibleNavbar\").removeClass(\"show\")\n            $(\"#my主体\").css(\"padding-top\", $(\"#my导航栏\").height());\n            \n            compile_into_dom(path, data, function() {\n                // rerender mathjax and reset mathjax equation counter\n                if (MathJax && MathJax.Extension[\"Tex/AMSmath\"]) {\n                    MathJax.Extension[\"TeX/AMSmath\"].startNumber = 0;\n                    MathJax.Extension[\"TeX/AMSmath\"].labels = {};\n\n                    var content = document.getElementById(\"content\");\n                    MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, content]);\n                }\n            });\n        }).fail(function() {\n            console.error(\"Opps! ... File not found!\\n5秒后返回主页\")\n            show_error(\"Opps! ... File not found!\\n5秒后返回主页\");\n            stop_loading();\n            setTimeout(()=>{\n                location.hash = \"#\"\n            }\n            , 5000)\n        });\n    }\n\n    function escape_html(string) {\n        return string.replace(/\\\\/g, \"&#92;\").replace(/\\_/g, \"&#95;\");\n    }\n\n    function unescape_html(string) {\n        return string.replace(/&amp;#92;/g, \"\\\\\").replace(/&amp;#95;/g, \"_\");\n    }\n\n    function compile_into_dom(path, data, cb) {\n        hide_errors();\n\n        data = create_youtube_embeds(data);\n        data = marked(escape_html(data));\n        data = unescape_html(data);\n        ditto.content_id.html(data);\n\n        stop_loading();\n        escape_github_badges(data);\n\n        normalize_paths();\n        create_page_anchors();\n\n        if (ditto.highlight_code) {\n            $('pre code').each(function(i, block) {\n                hljs.highlightBlock(block);\n            });\n        }\n\n        if (cb) {\n            cb(data);\n        }\n    }\n\n    function router() {\n        var hash = location.hash;\n\n        if (hash.slice(1, 7) !== \"search\") {\n            page_getter();\n\n        } else {\n            if (ditto.searchbar) {\n                github_search(hash.replace(\"#search=\", \"\"));\n            }\n\n        }\n    }\n\n    window.ditto = ditto;\n});\n"]}